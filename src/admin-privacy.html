<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Admin — Privacy Settings</title>
  <link rel="stylesheet" href="./styles.css">
  <meta name="app-version" content="0.1.0">
</head>
<body>
  <header class="site-header">
    <h1>Admin — Privacy</h1>
    <nav><a href="admin.html">Dashboard</a> · <a href="admin-settings.html">Settings</a></nav>
  </header>

  <main class="page-content">
    <section class="card">
      <h2>User-facing Privacy Controls</h2>
      <form id="privacyForm">
        <label>
          <input id="publicProfile" type="checkbox" checked>
          Allow users to make their profile public
        </label>

        <label>
          <input id="showContactInfo" type="checkbox" checked>
          Show contact information on property detail to other users
        </label>

        <label>
          <input id="showPhoneButton" type="checkbox" checked>
          Show direct contact button on listings
        </label>

        <label>
          <input id="dataSharing" type="checkbox">
          Enable data sharing with 3rd-party services (analytics/ads)
        </label>

        <label>
          <input id="analytics" type="checkbox" checked>
          Enable site analytics (collect anonymous usage data)
        </label>

        <div style="margin-top:12px">
          <button id="savePrivacy" class="btn">Save Privacy Settings</button>
        </div>
      </form>
    </section>

    <section class="card">
      <h2>Admin visibility</h2>
      <form id="adminPrivacyForm">
        <label>
          <input id="adminSeeUserContacts" type="checkbox" checked>
          Allow admins to view user contact details
        </label>
        <label>
          <input id="adminExportData" type="checkbox">
          Allow admins to export user data
        </label>
        <div style="margin-top:12px">
          <button id="saveAdminPrivacy" class="btn">Save Admin Privacy</button>
        </div>
      </form>
    </section>
  </main>

  <script src="./script.js"></script>
  <script>
    const postJson = (path, body)=>{
      if(typeof window.apiFetch === 'function') return window.apiFetch(path, { method: 'POST', body: JSON.stringify(body), headers:{'content-type':'application/json'} });
      return fetch(path, { method: 'POST', body: JSON.stringify(body), headers:{'content-type':'application/json'} }).catch(()=>null);
    };

    document.getElementById('savePrivacy').addEventListener('click', async (ev)=>{
      ev.preventDefault();
      const body = {
        publicProfile: document.getElementById('publicProfile').checked,
        showContactInfo: document.getElementById('showContactInfo').checked,
        showPhoneButton: document.getElementById('showPhoneButton').checked,
        dataSharing: document.getElementById('dataSharing').checked,
        analytics: document.getElementById('analytics').checked
      };
      const r = await postJson('/api/admin/privacy', body);
      if(r && r.ok) alert('Privacy settings saved'); else alert('Save failed (check console)');
    });

    document.getElementById('saveAdminPrivacy').addEventListener('click', async (ev)=>{
      ev.preventDefault();
      const body = {
        adminSeeUserContacts: document.getElementById('adminSeeUserContacts').checked,
        adminExportData: document.getElementById('adminExportData').checked
      };
      const r = await postJson('/api/admin/privacy/admin', body);
      if(r && r.ok) alert('Admin privacy saved'); else alert('Save failed (check console)');
    });
  </script>
</body>
</html>
